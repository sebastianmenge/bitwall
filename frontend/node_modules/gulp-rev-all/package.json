{
  "name": "gulp-rev-all",
  "version": "0.5.13",
  "description": "Static asset revisioning by appending content hash to filenames: unicorn.css => unicorn.098f6bcd.css, also re-writes references in each file to new reved name.",
  "main": "index.js",
  "dependencies": {
    "gulp-util": "~2.2.14",
    "event-stream": "~3.1.0",
    "through2": "~0.4.0",
    "chalk": "~0.4.0",
    "graceful-fs": "~3.0.2",
    "underscore": "~1.6.0",
    "sinon": "~1.10.2"
  },
  "devDependencies": {
    "glob": "~3.2.9",
    "gulp": "~3.5.5",
    "gulp-jshint": "~1.5.1",
    "gulp-mocha": "~0.4.1",
    "gulp-util": "~2.2.0",
    "mocha": "~1.13.0",
    "should": "*"
  },
  "scripts": {
    "test": "mocha test.js"
  },
  "repository": {
    "type": "git",
    "url": "git://github.com/smysnk/gulp-rev-all.git"
  },
  "keywords": [
    "gulpplugin",
    "rev",
    "all",
    "revision",
    "hash",
    "optimize",
    "version",
    "versioning",
    "cache",
    "expire",
    "static",
    "asset",
    "assets",
    "aws",
    "s3",
    "cloudfront",
    "cdn"
  ],
  "homepage": "https://github.com/smysnk/gulp-rev-all",
  "author": {
    "name": "Joshua Bellamy-Henn",
    "email": "smysnk@gmail.com"
  },
  "license": "MIT",
  "bugs": {
    "url": "https://github.com/smysnk/gulp-rev-all/issues"
  },
  "engines": {
    "node": ">=0.8"
  },
  "readme": "# [gulp](https://github.com/wearefractal/gulp)-rev-all [![Build Status](https://travis-ci.org/smysnk/gulp-rev-all.png?branch=master)](https://travis-ci.org/smysnk/gulp-rev-all)\n\n> Static asset revisioning with dependency considerations, appends content hash to each filename (eg. unicorn.css => unicorn.098f6bcd.css), re-writes references.\n\n\n## Purpose\n\nBy using the Expires header you can make static assets cacheable for extended periods of time so that visitors to your website do not need to make unnecessary HTTP requests for subsequent page views.\nAlso content distribution networks like [CloudFront](http://aws.amazon.com/cloudfront/) let you cache static assets in [Edge Locations](http://aws.amazon.com/about-aws/globalinfrastructure/) for extended periods of time.\nA problem occurs however when you go to release a new version of your website, previous visitors of your website will hit their cache instead.\nIn the case of CloudFront, you will need to invalidate items or wait for the cache TTL to expire before vistors of your website will see the vew version.\n\nA solution to this problem is adding a revisioned number to the name your static assets.  In the case of this gulp plugin, the revision number is `md5( md5(file) + md5(reference1) + md5(reference2) + md5(reference..) ).substr(0, 8)`.  eg. unicorn.css => unicorn.098f6bcd.css\n\n\n## Why fork?\n\nThis project was forked from [gulp-rev](https://github.com/sindresorhus/gulp-rev) to add reference processing and rewriting functionality.  \nIt is the philosophy of `gulp-rev` that concerns should be seperated between revisioning the files and correcting internal references.  That is to say it is not `gulp-rev`'s responsibility to analyse or re-write references.\n`gulp-rev-all` does not agree with this idea for the simple reason that to accurately calculate a file's hash for caching purposes you need to take child references in to consideration.\n\neg. A revisioned css file makes a reference to an image.  If the image contents changes, the hash of the css file will remain the same since none of its contents have changed.  Web clients that have previously cached this css file will not correctly resolve the new image file.\nIf we take in to consideration the dependency graph while calculating the css file hash, we can have it change if any of it child references have changed.\n\nSo to recap, `gulp-rev-all` not only handles reference re-writing but it also takes child references into consideration when calculating a hashes.\n\n\n## Install\n\nInstall with [npm](https://npmjs.org/)\n\n```\nnpm install --save-dev gulp-rev-all\n```\n\n## Example\n\n```js\nvar gulp = require('gulp');\nvar revall = require('gulp-rev-all');\n\ngulp.task('default', function () {\n    gulp.src('dist/**')\n        .pipe(revall())\n        .pipe(gulp.dest('cdn'));\n});\n```\n\n\n```js\nvar gulp = require('gulp');\nvar revall = require('gulp-rev-all');\nvar awspublish = require('gulp-awspublish');\nvar cloudfront = require(\"gulp-cloudfront\");\n\nvar aws = {\n    \"key\": \"AKIAI3Z7CUAFHG53DMJA\",\n    \"secret\": \"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\",\n    \"bucket\": \"bucket-name\",\n    \"region\": \"us-standard\",\n    \"distributionId\": \"E1SYAKGEMSK3OD\"\n};\n\nvar publisher = awspublish.create(aws);\nvar headers = {'Cache-Control': 'max-age=315360000, no-transform, public'};\n\ngulp.task('default', function () {\n    gulp.src('dist/**')\n        .pipe(revall())\n        .pipe(awspublish.gzip())\n        .pipe(publisher.publish(headers))\n        .pipe(publisher.cache())\n        .pipe(awspublish.reporter())\n        .pipe(cloudfront(aws));\n});\n```\n\n  * See [gulp-awspublish](https://www.npmjs.org/package/gulp-awspublish), [gulp-cloudfront](https://www.npmjs.org/package/gulp-cloudfront)\n\n\n## API\n\n#### options.ignore\n\nType: `Array of RegEx or String`\nDefault: `[ /^\\/favicon.ico$/ ]`\n\nIn some cases, you may not want to rev your `*.html` files:\n\n```js\ngulp.task('default', function () {\n    gulp.src('dist/**')\n        .pipe(revall({ ignore: [/^\\/favicon.ico$/g, '.html'] }))\n        .pipe(gulp.dest('cdn'))\n});\n```\n\nEvery html file except the root `/index.html` file:\n\n```js\ngulp.task('default', function () {\n    gulp.src('dist/**')\n        .pipe(revall({ ignore: [/^\\/favicon.ico$/g, /^\\/index.html/g] }))\n        .pipe(gulp.dest('cdn'))\n});\n```\n\n#### options.hashLength\n\nType: `hashLength`\nDefault: `8`\n\nChange the length of the hash appended to the end of each revisioned file (use `options.transformFilename` for more complicated scenarios).\n\n```js\ngulp.task('default', function () {\n    gulp.src('dist/**')\n        .pipe(revall({ hashLength: 4 }))\n        .pipe(gulp.dest('cdn'))\n});\n```\n\n#### options.prefix\n\nType: `prefix`\nDefault: `none`\n\nPrefixes matched files with a string (use `options.transformPath` for more complicated scenarios). Useful for adding a full url path to files.\n\n```js\ngulp.task('default', function () {\n    gulp.src('dist/**')\n        .pipe(revall({ prefix: 'http://1234.cloudfront.net/' }))\n        .pipe(gulp.dest('cdn'))\n});\n```\n\n#### options.transformPath\n\nType: `function (rev, source, path)`\nDefault: `none`\n\nSpecify a function to transform the reference path. Useful in instances where the local file structure does not reflect what the remote file structure will be.\n\nThe function takes three arguments:\n  - `rev` - revisioned reference path\n  - `source` - original reference path\n  - `path` - path to the file\n\n\n```js\ngulp.task('default', function () {\n    gulp.src('dist/**')\n        .pipe(revall({\n            transformPath: function (rev, source, path) {\n                // on the remote server, image files are served from `/images`\n                return rev.replace('/img', '/images');\n            }\n        }))\n        .pipe(gulp.dest('cdn'))\n});\n```\n\n#### options.transformFilename\n\nType: `function (file, hash)`\nDefault: `none`\n\nIf the default naming convention does not suite your needs, you can specify a custom filename transform. \n\nThe function takes one argument:\n  - `file` - file to be revisioned\n  - `hash` - calculated hash of the file\n\n```js\ngulp.task('default', function () {\n    gulp.src('dist/**')\n        .pipe(revall({\n            transformFilename: function (file, hash) {\n                var ext = path.extname(file.path);\n                return hash.substr(0, 5) + '.'  + path.basename(file.path, ext) + ext; // 3410c.filename.ext\n            }\n        }))\n        .pipe(gulp.dest('cdn'))\n});\n```\n\n## Tips\n\nMake sure to set the files to [never expire](http://developer.yahoo.com/performance/rules.html#expires) for this to have an effect.\n\n\n## License\n\n[MIT](http://opensource.org/licenses/MIT) Â© [Joshua Bellamy-Henn](http://www.psidox.com)\n",
  "readmeFilename": "README.md",
  "_id": "gulp-rev-all@0.5.13",
  "_shasum": "60c3050dda741b3621d96458f7dcff14963aee52",
  "_from": "gulp-rev-all@^0.5.11",
  "_resolved": "https://registry.npmjs.org/gulp-rev-all/-/gulp-rev-all-0.5.13.tgz"
}
